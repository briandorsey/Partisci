

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Partisci 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="None" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="#">Partisci 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="welcome-to-partisci-s-documentation">
<h1>Welcome to Partisci&#8217;s documentation!<a class="headerlink" href="#welcome-to-partisci-s-documentation" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This project is using readme driven development and has not been implemented yet.</p>
</div>
<p>Where is your software installed?  Is version X still in use anywhere?</p>
<p>Partisci answers these questions by collecting updates from your programs and providing a REST API to access the data.</p>
<dl class="docutils">
<dt>Partisci can answer these questions:</dt>
<dd><ul class="first last simple">
<li>What hosts is application X installed on?</li>
<li>Which versions of application X are active?</li>
<li>Is version Y of application X still active anywhere?</li>
<li>Which hosts are runinng version Y of application X?</li>
<li>When did application X last update? (from host Z?)</li>
<li>What applications are installed on host Z?</li>
</ul>
</dd>
</dl>
<p>However, Partisci <em>only</em> knows about applications which have been modified to send it updates.</p>
<div class="section" id="details">
<h2>Details<a class="headerlink" href="#details" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>Some limitations:</dt>
<dd><ul class="first last simple">
<li>Applications must be modified to send updates.</li>
<li>If applications are not running, no information is updated.</li>
<li>Partisci only logs the most recent data fro each host/app/instance combination. In the future, Partisci may keep more historical data.</li>
<li>It is intended to be used within an organization to track custom software. It has no features to support publicly released software, or anything your organization can&#8217;t modify.</li>
</ul>
</dd>
</dl>
<p>Partisci accepts update updates via UDP and HTTP. Sending UDP updates is recommended. When UDP isn&#8217;t easy or possible, use HTTP (for example: network restrictions or browser based apps). Partisci requres each application to be modified to send these updates.</p>
<dl class="docutils">
<dt>Updates contain:</dt>
<dd><ul class="first last simple">
<li>application name</li>
<li>version</li>
<li>hostname</li>
<li>instance number</li>
</ul>
</dd>
<dt>Partisci also logs:</dt>
<dd><ul class="first last simple">
<li>client address (as seen by Partisci)</li>
<li>time the update is recieved</li>
</ul>
</dd>
<dt>Where does the name come from?</dt>
<dd><ul class="first last simple">
<li>It is a truncated portmanteau from Partially Omniscient. Within its limited domain, Partisci strives to be omniscient.</li>
</ul>
</dd>
</dl>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<span id="document-api"></span><div class="section" id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h3>
<p>Partisci provides access to the data it collects via a REST API.</p>
<p>The REST API also inclues an update resource for situtaions where applications cannot update via UDP.</p>
<p>Partisci can answer the following questions:</p>
<blockquote>
<div><ul class="simple">
<li>Which hosts is application A installed on?</li>
<li>Which versions of application A are active?</li>
<li>Is version V of application A still active anywhere?</li>
<li>Which hosts are runinng version V of application A?</li>
<li>When did application A last update? (from host H?)</li>
<li>What applications are installed on host H?</li>
</ul>
</div></blockquote>
<p>All of the following urls are rooted at <tt class="docutils literal"><span class="pre">/api/v1/</span></tt>. Ex: <tt class="docutils literal"><span class="pre">summary/app/</span></tt> is at
<tt class="docutils literal"><span class="pre">/api/v1/summary/app/</span></tt>.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="36%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">verb</th>
<th class="head">path</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>GET</td>
<td>_partisci/</td>
<td>information about this partisci instance</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>summary/app/</td>
<td>distinct active applications</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>summary/hosts/</td>
<td>distinct active hosts</td>
</tr>
<tr class="row-odd"><td>&#8212;</td>
<td>&#8212;</td>
<td>&#8212; items below not implemented yet</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>&nbsp;</td>
<td>overview</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>version/?app=A</td>
<td>&#8216;version&#8217;s for every H running A</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>version/?app=A&amp;host=H</td>
<td>&#8216;version&#8217;s for app A on H</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>version/?app=A&amp;version=V</td>
<td>&#8216;version&#8217;s for app A, version V</td>
</tr>
<tr class="row-even"><td>GET</td>
<td>version/?host=H</td>
<td>&#8216;version&#8217;s for all A on host H</td>
</tr>
<tr class="row-odd"><td>GET</td>
<td>summary/hosts/?app=A</td>
<td>distinct active hosts running A</td>
</tr>
<tr class="row-even"><td>POST</td>
<td>update/</td>
<td>endpoint for appliction updates</td>
</tr>
<tr class="row-odd"><td>&#8212;</td>
<td>&#8212;</td>
<td>&#8212; only when running in -danger mode</td>
</tr>
<tr class="row-even"><td>POST</td>
<td>_danger/clear/</td>
<td>clear the entire version database</td>
</tr>
</tbody>
</table>
<div class="section" id="version-json">
<h4>Version JSON<a class="headerlink" href="#version-json" title="Permalink to this headline">¶</a></h4>
<p>Version updates have the following JSON structure:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
  <span class="s">&quot;app&quot;</span> <span class="p">:</span> <span class="s">&quot;Application Name&quot;</span><span class="p">,</span>
  <span class="s">&quot;version&quot;</span> <span class="p">:</span> <span class="s">&quot;1.2.3dev&quot;</span><span class="p">,</span>
  <span class="s">&quot;host&quot;</span> <span class="p">:</span> <span class="s">&quot;hostname&quot;</span><span class="p">,</span>
  <span class="s">&quot;instance&quot;</span> <span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
<span class="p">}</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">app</span></tt>, <tt class="docutils literal"><span class="pre">version</span></tt> &amp; <tt class="docutils literal"><span class="pre">host</span></tt> are limited to 50 unicode characters &amp;
<tt class="docutils literal"><span class="pre">instance</span></tt> is an integer 0-65535 (uint16).</p>
<p>When returned from Partisci, the following additional fields will be added:</p>
<div class="highlight-python"><pre>"app_id" : "application_name"
"host_ip" : "10.0.0.1"
"last_update" : 1327940599</pre>
</div>
<p>Where <tt class="docutils literal"><span class="pre">host_ip</span></tt> is the IP address of the sending machine as seen by Partisci
and <tt class="docutils literal"><span class="pre">last_update</span></tt> is a unix epoch time stamp, rounded to the nearest second.
<tt class="docutils literal"><span class="pre">app_id</span></tt> is a simplified form of <tt class="docutils literal"><span class="pre">app</span></tt> for use in referring to the application in the REST API.</p>
<p>All <tt class="docutils literal"><span class="pre">version/</span></tt> urls return a full version JSON object. The <tt class="docutils literal"><span class="pre">summary/</span></tt> urls return a subset of the fields.</p>
</div>
<div class="section" id="update-clients">
<h4>Update clients<a class="headerlink" href="#update-clients" title="Permalink to this headline">¶</a></h4>
<p>Clients should send update packets via UDP. Update packets are raw UTF8 encoded bytes containing the version JSON.</p>
<p>For clients which cannot use UDP, they can post the version JSON to the
<tt class="docutils literal"><span class="pre">update/</span></tt> URL.</p>
</div>
<div class="section" id="update-timing-recommendations">
<h4>Update timing recommendations<a class="headerlink" href="#update-timing-recommendations" title="Permalink to this headline">¶</a></h4>
<p>Clients should send a version update at every start up. Long running processes should send an update at least once every 24 hours, but not more than every hour.</p>
</div>
<div class="section" id="example-client-in-python">
<h4>Example client in Python<a class="headerlink" href="#example-client-in-python" title="Permalink to this headline">¶</a></h4>
<p>&lt;TODO&gt;</p>
</div>
<div class="section" id="rest-api-details">
<h4>REST API details<a class="headerlink" href="#rest-api-details" title="Permalink to this headline">¶</a></h4>
<p>All response bodies are JSON objects.</p>
<p>The examples below assume Partisci is running on localhost, port 7777 (default).</p>
</div>
<div class="section" id="get-api-v1-partisci">
<h4>GET /api/v1/_partisci/<a class="headerlink" href="#get-api-v1-partisci" title="Permalink to this headline">¶</a></h4>
<p>This call returns basic information about the Partisci instance. Currently, very limited.</p>
<div class="highlight-text"><div class="highlight"><pre>$ curl -s http://localhost:7777/api/v1/_partisci/ | python -m json.tool
{
    &quot;version&quot;: &quot;0.1&quot;
}
</pre></div>
</div>
</div>
<div class="section" id="get-api-v1-summary-app">
<h4>GET /api/v1/summary/app/<a class="headerlink" href="#get-api-v1-summary-app" title="Permalink to this headline">¶</a></h4>
<p>The response contains a distinct list of all known application names,
<tt class="docutils literal"><span class="pre">app_id``s,</span> <span class="pre">``last_update</span></tt> for any version of the app from any host.</p>
<div class="highlight-text"><div class="highlight"><pre>$ curl -s http://localhost:7777/api/v1/summary/app/ | python -m json.tool
{
    &quot;data&quot;: [
        {
            &quot;app&quot;: &quot;Demo App C&quot;, 
            &quot;app_id&quot;: &quot;demo_app_c&quot;, 
            &quot;last_update&quot;: 1328467109
        }, 
        {
            &quot;app&quot;: &quot;Demo App B&quot;, 
            &quot;app_id&quot;: &quot;demo_app_b&quot;, 
            &quot;last_update&quot;: 1328467109
        }, 
        {
            &quot;app&quot;: &quot;Demo App A&quot;, 
            &quot;app_id&quot;: &quot;demo_app_a&quot;, 
            &quot;last_update&quot;: 1328467109
        }
    ]
}
</pre></div>
</div>
</div>
<div class="section" id="get-api-v1-summary-host">
<h4>GET /api/v1/summary/host/<a class="headerlink" href="#get-api-v1-summary-host" title="Permalink to this headline">¶</a></h4>
<p>The response contains a distinct list of all known hosts and the
<tt class="docutils literal"><span class="pre">last_update</span></tt> for any version and any application.</p>
<div class="highlight-text"><div class="highlight"><pre>$ curl -s http://localhost:7777/api/v1/summary/host/ | python -m json.tool
{
    &quot;data&quot;: [
        {
            &quot;host&quot;: &quot;host1.example.com&quot;, 
            &quot;last_update&quot;: 1328467109
        }, 
        {
            &quot;host&quot;: &quot;host2.example.com&quot;, 
            &quot;last_update&quot;: 1328467109
        }
    ]
}
</pre></div>
</div>
</div>
</div>
<span id="document-testing"></span><div class="section" id="testing">
<h3>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h3>
<div class="section" id="requirements-running-the-tests">
<h4>Requirements &amp; running the tests<a class="headerlink" href="#requirements-running-the-tests" title="Permalink to this headline">¶</a></h4>
<p>Partisci itself is written in Go (golang.org). The (whitebox) test suite is written in Python. To run the tests, you&#8217;ll need Python 2.7x and the following modules:</p>
<blockquote>
<div><ul class="simple">
<li>py.test (pytest.org)</li>
<li>requests (python-requests.org)</li>
</ul>
</div></blockquote>
<p>Open a shell to the test directory and run:</p>
<div class="highlight-python"><pre>$ py.test</pre>
</div>
</div>
</div>
<span id="document-status"></span><div class="section" id="implementation-status">
<h3>Implementation Status<a class="headerlink" href="#implementation-status" title="Permalink to this headline">¶</a></h3>
<div class="section" id="implemented">
<h4>Implemented<a class="headerlink" href="#implemented" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>Initial documentation</li>
<li>example Python update module</li>
<li>initial UDP listener</li>
<li>implement a benchmark test for update parsing</li>
<li>barebones REST API with tests</li>
<li>in-memory version storage and interface</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="planned">
<h4>Planned<a class="headerlink" href="#planned" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><ul class="simple">
<li>fully implement documented REST API</li>
<li>implement version timeout and config (only active versions kept)<ul>
<li>and/or - make this a query parameter?</li>
</ul>
</li>
<li>implement and test multiple instance support</li>
<li>add relative URLs queries in API results</li>
<li>write golang update client</li>
<li>python client: add start_update_thread(), docs</li>
<li>create partisci_fuzz tool to synthesize many fake updates</li>
<li>Persistent store for the version data</li>
<li>Setup build system<ul>
<li>create source distribution package with pre-built documentation</li>
<li>post pre-built documentation online</li>
<li>Windows binaries</li>
<li>OS/X binaries</li>
<li>linux binaries</li>
</ul>
</li>
<li>write quickstart documentation</li>
<li>gzip responses when possible</li>
<li>Add paging to REST results</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="possible">
<h4>Possible<a class="headerlink" href="#possible" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Store more historical data from updates.<ul>
<li>Last update time for each app/version/machine. This would give a full version history for each machine.</li>
</ul>
</li>
<li>Store application specific state information.</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference internal" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-api">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#version-json">Version JSON</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#update-clients">Update clients</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#update-timing-recommendations">Update timing recommendations</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#example-client-in-python">Example client in Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#rest-api-details">REST API details</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#get-api-v1-partisci">GET /api/v1/_partisci/</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#get-api-v1-summary-app">GET /api/v1/summary/app/</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#get-api-v1-summary-host">GET /api/v1/summary/host/</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-testing">Testing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#requirements-running-the-tests">Requirements &amp; running the tests</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-status">Implementation Status</a><ul>
<li class="toctree-l2"><a class="reference internal" href="index.html#implemented">Implemented</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#planned">Planned</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#possible">Possible</a></li>
</ul>
</li>
</ul>

<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li><a href="#">Partisci 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Brian Dorsey.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>